{"version":3,"file":"mithril-infinite.js","sources":["../node_modules/j2c/dist/j2c.commonjs.js","../src/classes.js","../node_modules/verge/verge.js","../src/util.js","../node_modules/mithril/stream/stream.js","../node_modules/mithril/stream.js","../src/page.js","../src/placeholder.js","../src/styler.js","../src/css.js","../src/index.js"],"sourcesContent":["'use strict';\n\nvar emptyArray = [];\nvar emptyObject = {};\nvar type = emptyObject.toString;\nvar ARRAY =  type.call(emptyArray);\nvar OBJECT = type.call(emptyObject);\nvar STRING = type.call('');\nvar FUNCTION = type.call(type);\nvar own =  emptyObject.hasOwnProperty;\nvar freeze = Object.freeze || function(o) {return o};\n\n\nfunction defaults(target, source) {\n  for (var k in source) if (own.call(source, k)) {\n    if (k.indexOf('$') && !(k in target)) target[k] = source[k];\n  }\n  return target\n}\n\nfunction cartesian(a,b) {\n  var res = [], i, j;\n  for (j in b) if(own.call(b, j))\n    for (i in a) if(own.call(a, i))\n      res.push(a[i] + b[j]);\n  return res\n}\n\n// \"Tokenizes\" the selectors into parts relevant for the next function.\n// Strings and comments are matched, but ignored afterwards.\n// This is not a full tokenizers. It only recognizes comas, parentheses,\n// strings and comments.\n// regexp generated by scripts/regexps.js then trimmed by hand\nvar selectorTokenizer = /[(),]|\"(?:\\\\.|[^\"\\n])*\"|'(?:\\\\.|[^'\\n])*'|\\/\\*[\\s\\S]*?\\*\\//g;\n\n\n/**\n * This will split a coma-separated selector list into individual selectors,\n * ignoring comas in strings, comments and in :pseudo-selectors(parameter, lists).\n *\n * @param {string} selector\n * @return {string[]}\n */\n\nfunction splitSelector(selector) {\n  var indices = [], res = [], inParen = 0, o;\n  /*eslint-disable no-cond-assign*/\n  while (o = selectorTokenizer.exec(selector)) {\n  /*eslint-enable no-cond-assign*/\n    switch (o[0]) {\n    case '(': inParen++; break\n    case ')': inParen--; break\n    case ',': if (inParen) break; indices.push(o.index);\n    }\n  }\n  for (o = indices.length; o--;){\n    res.unshift(selector.slice(indices[o] + 1));\n    selector = selector.slice(0, indices[o]);\n  }\n  res.unshift(selector);\n  return res\n}\n\n// Like the `selectorTokenizer`, but for the `&` operator\nvar ampersandTokenizer = /&|\"(?:\\\\.|[^\"\\n])*\"|'(?:\\\\.|[^'\\n])*'|\\/\\*[\\s\\S]*?\\*\\//g;\n\nfunction ampersand (selector, parents) {\n  var indices = [], split = [], res, o;\n  /*eslint-disable no-cond-assign*/\n  while (o = ampersandTokenizer.exec(selector)) {\n  /*eslint-enable no-cond-assign*/\n    if (o[0] == '&') indices.push(o.index);\n  }\n  for (o = indices.length; o--;){\n    split.unshift(selector.slice(indices[o] + 1));\n    selector = selector.slice(0, indices[o]);\n  }\n  split.unshift(selector);\n  if (split.length === 1) split.unshift('');\n  res = [split[0]];\n  for (o = 1; o < split.length; o++) {\n    res = cartesian(res, cartesian(parents, [split[o]]));\n  }\n  return res.join(',')\n}\n\nfunction flatIter (f) {\n  return function iter(arg) {\n    if (type.call(arg) === ARRAY) for (var i= 0 ; i < arg.length; i ++) iter(arg[i]);\n    else f(arg);\n  }\n}\n\nfunction decamelize(match) {\n  return '-' + match.toLowerCase()\n}\n\n/**\n * Handles the property:value; pairs.\n *\n * @param {object} state - holds the localizer- and walker-related methods\n *                         and state\n * @param {object} emit - the contextual emitters to the final buffer\n * @param {string} prefix - the current property or a prefix in case of nested\n *                          sub-properties.\n * @param {array|object|string} o - the declarations.\n * @param {boolean} local - are we in @local or in @global scope.\n */\n\nfunction declarations(state, emit, prefix, o, local) {\n  var k, v, kk;\n  if (o==null) return\n\n  switch ( type.call(o = o.valueOf()) ) {\n  case ARRAY:\n    for (k = 0; k < o.length; k++)\n\n      declarations(state, emit, prefix, o[k], local);\n\n    break\n  case OBJECT:\n    // prefix is falsy iif it is the empty string, which means we're at the root\n    // of the declarations list.\n    prefix = (prefix && prefix + '-');\n    for (k in o) if (own.call(o, k)){\n      v = o[k];\n      if (/\\$/.test(k)) {\n        for (kk in (k = k.split('$'))) if (own.call(k, kk)) {\n\n          declarations(state, emit, prefix + k[kk], v, local);\n\n        }\n      } else {\n\n        declarations(state, emit, prefix + k, v, local);\n\n      }\n    }\n    break\n  default:\n    // prefix is falsy when it is \"\", which means that we're\n    // at the top level.\n    // `o` is then treated as a `property:value` pair, or a\n    // semi-colon-separated list thereof.\n    // Otherwise, `prefix` is the property name, and\n    // `o` is the value.\n\n    // restore the dashes\n    k = prefix.replace(/_/g, '-').replace(/[A-Z]/g, decamelize);\n\n    if (local && (k == 'animation-name' || k == 'animation' || k == 'list-style')) {\n      // no need to tokenize here a plain `.split(',')` has all bases covered.\n      // We may 'localize' a comment, but it's not a big deal.\n      o = o.split(',').map(function (o) {\n\n        return o.replace(/^\\s*(?:(var\\([^)]+\\))|:?global\\(\\s*([_A-Za-z][-\\w]*)\\s*\\)|()(-?[_A-Za-z][-\\w]*))/, state.localizeReplacer)\n\n      }).join(',');\n    }\n\n    emit.decl(k, o);\n\n  }\n}\n\n/**\n * Handles a single at-rules\n *\n * @param {object} state - holds the localizer- and walker-related methods\n *                         and state\n * @param {object} emit - the contextual emitters to the final buffer\n * @param {array} k - The parsed at-rule, including the parameters,\n *                    if takes both parameters and a block.\n *                    k == [match, fullAtRule, atRuleType, params?]\n *                    So in `@-webkit-keyframes foo`, we have\n *                     - match = \"@-webkit-keyframes foo\"\n *                     - fullAtRule = \"@-webkit-keyframes\"\n *                     - atRuleType = \"keyframes\"\n *                     - params = \"foo\"\n * @param {string|string[]|object|object[]} v - Either parameters for\n *                                              block-less rules or\n *                                              their block\n *                                              for the others.\n * @param {string} prefix - the current selector or the selector prefix\n *                          in case of nested rules\n * @param {boolean} local - are we in @local or in @global scope?\n * @param {string} nestingDepth - are we nested in an at-rule or a selector?\n */\n\nfunction atRules(state, emit, k, v, prefix, local, nestingDepth) {\n\n  // First iterate over user-provided at-rules and return if one of them corresponds to the current one\n  for (var i = 0; i < state.$atHandlers.length; i++) {\n\n    if (state.$atHandlers[i](state, emit, k, v, prefix, local, nestingDepth)) return\n\n  }\n\n  // using `/^global$/.test(k[2])` rather that 'global' == k[2] gzips\n  // slightly better thanks to the regexps tests further down.\n  // It is slightly less efficient but this isn't a critical path.\n\n  if (!k[3] && /^global$/.test(k[2])) {\n\n    rules(state, emit, prefix, v, 0, nestingDepth);\n\n\n  } else if (!k[3] && /^local$/.test(k[2])) {\n\n    rules(state, emit, prefix, v, 1, nestingDepth);\n\n\n  } else if (k[3] && /^adopt$/.test(k[2])) {\n\n    if (!local || nestingDepth) return emit.err('@adopt global or nested: ' + k[0])\n\n    if (!/^\\.?[_A-Za-z][-\\w]*$/.test(k[3])) return emit.err('bad adopter ' + JSON.stringify(k[3]) + ' in ' + k[0])\n\n    i = [];\n    flatIter(function(adoptee, asString) {\n\n      if(adoptee == null || !/^\\.?[_A-Za-z][-\\w]*(?:\\s+\\.?[_A-Za-z][-\\w]*)*$/.test(asString = adoptee + '')) emit.err('bad adoptee '+ JSON.stringify(adoptee) + ' in ' + k[0]);\n\n      else i.push(asString.replace(/\\./g, ''));\n\n    })(v);\n\n    // we may end up with duplicate classes but AFAIK it has no consequences on specificity.\n    if (i.length) {\n      state.localize(k[3] = k[3].replace(/\\./g, ''));\n      state.names[k[3]] += (' ' + i.join(' '));\n    }\n\n\n  } else if (!k[3] && /^(?:namespace|import|charset)$/.test(k[2])) {\n    flatIter(function(v) {\n\n      emit.atrule(k[1], k[2], v);\n\n    })(v);\n\n\n  } else if (!k[3] && /^(?:font-face|viewport)$/.test(k[2])) {\n    flatIter(function(v) {\n\n      emit.atrule(k[1], k[2], k[3], 1);\n\n      declarations(state, emit, '', v, local);\n\n      emit._atrule();\n\n    })(v);\n\n  } else if (k[3] && /^(?:media|supports|page|keyframes)$/.test(k[2])) {\n\n    if (local && 'keyframes' == k[2]) {\n      k[3] = k[3].replace(\n        // generated by script/regexps.js\n        /(var\\([^)]+\\))|:?global\\(\\s*([_A-Za-z][-\\w]*)\\s*\\)|()(-?[_A-Za-z][-\\w]*)/,\n        state.localizeReplacer\n      );\n    }\n\n\n    emit.atrule(k[1], k[2], k[3], 1);\n\n    if ('page' == k[2]) {\n\n      declarations(state, emit, '', v, local);\n\n    } else {\n\n      rules(\n        state, emit,\n        'keyframes' == k[2] ? '' : prefix,\n        v, local, nestingDepth + 1\n      );\n\n    }\n\n    emit._atrule();\n\n  } else {\n\n    emit.err('Unsupported at-rule: ' + k[0]);\n\n  }\n}\n\n/**\n * Add rulesets and other CSS tree to the sheet.\n *\n * @param {object} state - holds the localizer- and walker-related methods\n *                         and state\n * @param {object} emit - the contextual emitters to the final buffer\n * @param {string} prefix - the current selector or a prefix in case of nested rules\n * @param {array|string|object} tree - a source object or sub-object.\n * @param {string} nestingDepth - are we nested in an at-rule?\n * @param {boolean} local - are we in @local or in @global scope?\n */\nfunction rules(state, emit, prefix, tree, local, nestingDepth) {\n  var k, v, inDeclaration, kk;\n\n  switch (type.call(tree)) {\n\n  case OBJECT:\n    for (k in tree) if (own.call(tree, k)) {\n      v = tree[k];\n\n      if (prefix.length > 0 && /^[-\\w$]+$/.test(k)) {\n        if (!inDeclaration) {\n          inDeclaration = 1;\n\n          emit.rule(prefix);\n\n        }\n        if (/\\$/.test(k)) {\n          for (kk in (k = k.split('$'))) if (own.call(k, kk)) {\n\n            declarations(state, emit, k[kk], v, local);\n\n          }\n        } else {\n\n          declarations(state, emit, k, v, local);\n\n        }\n\n      } else if (/^@/.test(k)) {\n        // Handle At-rules\n        inDeclaration = 0;\n\n        atRules(state, emit,\n          /^(.(?:-[\\w]+-)?([_A-Za-z][-\\w]*))\\b\\s*(.*?)\\s*$/.exec(k) || [k,'@','',''],\n          v, prefix, local, nestingDepth\n        );\n\n      } else {\n        // selector or nested sub-selectors\n        inDeclaration = 0;\n\n        rules(\n          state, emit,\n          // build the selector `prefix` for the next iteration.\n          // ugly and full of redundant bits but so far the fastest/shortest.gz\n          /*0 if*/(prefix.length > 0 && (/,/.test(prefix) || /,/.test(k))) ?\n\n            /*0 then*/ (kk = splitSelector(prefix), splitSelector(\n              local ?\n\n                k.replace(\n                  /(\"(?:\\\\.|[^\"\\n])*\"|'(?:\\\\.|[^'\\n])*'|\\/\\*[\\s\\S]*?\\*\\/)|:global\\(\\s*(\\.-?[_A-Za-z][-\\w]*)\\s*\\)|(\\.)(-?[_A-Za-z][-\\w]*)/g,\n                  state.localizeReplacer\n                ) :\n\n                k\n            ).map(function (k) {\n              return /&/.test(k) ? ampersand(k, kk) : kk.map(function(kk) {\n                return kk + k\n              }).join(',')\n            }).join(',')) :\n\n            /*0 else*/ /*1 if*/ /&/.test(k) ?\n\n              /*1 then*/ ampersand(\n                local ?\n\n                  k.replace(\n                    /(\"(?:\\\\.|[^\"\\n])*\"|'(?:\\\\.|[^'\\n])*'|\\/\\*[\\s\\S]*?\\*\\/)|:global\\(\\s*(\\.-?[_A-Za-z][-\\w]*)\\s*\\)|(\\.)(-?[_A-Za-z][-\\w]*)/g,\n                    state.localizeReplacer\n                  ) :\n\n                  k,\n                [prefix]\n              ) :\n\n              /*1 else*/ prefix + (\n                local ?\n\n                  k.replace(\n                    /(\"(?:\\\\.|[^\"\\n])*\"|'(?:\\\\.|[^'\\n])*'|\\/\\*[\\s\\S]*?\\*\\/)|:global\\(\\s*(\\.-?[_A-Za-z][-\\w]*)\\s*\\)|(\\.)(-?[_A-Za-z][-\\w]*)/g,\n                    state.localizeReplacer\n                  ) :\n\n                  k\n                ),\n           v, local, nestingDepth + 1\n        );\n\n      }\n    }\n\n    break\n\n  case ARRAY:\n    for (k = 0; k < tree.length; k++){\n\n      rules(state, emit, prefix, tree[k], local, nestingDepth);\n\n    }\n    break\n\n  case STRING:\n    // CSS hacks or ouptut of `j2c.inline`.\n    if (!prefix.length) emit.err('No selector');\n    emit.rule(prefix || ' ');\n\n    declarations(state, emit, '', tree, local);\n\n  }\n}\n\n// This is the first entry in the filters array, which is\n// actually the last step of the compiler. It inserts\n// closing braces to close normal (non at-) rules (those\n// that start with a selector). Doing it earlier is\n// impossible without passing state around in unrelated code\n// or ending up with duplicated selectors when the source tree\n// contains arrays.\n// There's no `_rule` handler, because the core compiler never\n// calls it.\nfunction closeSelectors(next, inline) {\n  var lastSelector;\n  return inline ? next : {\n    init: function(){lastSelector = 0; next.init();},\n    done: function (raw) {\n      if (lastSelector) {next._rule(); lastSelector = 0;}\n      return next.done(raw)\n    },\n    atrule: function (rule, kind, param, takesBlock) {\n      if (lastSelector) {next._rule(); lastSelector = 0;}\n      next.atrule(rule, kind, param, takesBlock);\n    },\n    _atrule: function (rule) {\n      if (lastSelector) {next._rule(); lastSelector = 0;}\n      next._atrule(rule);\n    },\n    rule: function (selector) {\n      if (selector !== lastSelector){\n        if (lastSelector) next._rule();\n        next.rule(selector);\n        lastSelector = selector;\n      }\n    }\n  }\n}\n\nfunction global(x) {\n  return ':global(' + x + ')'\n}\n\nfunction kv (k, v, o) {\n  o = {};\n  o[k] = v;\n  return o\n}\n\nfunction at (rule, params, block) {\n  if (\n    arguments.length < 3\n  ) {\n    // inner curry!\n    var _at = at.bind.apply(at, [null].concat([].slice.call(arguments,0)));\n    // So that it can be used as a key in an ES6 object literal.\n    _at.toString = function(){return '@' + rule + ' ' + params};\n    return _at\n  }\n  else return kv('@' + rule +' ' + params, block)\n}\n\nfunction j2c() {\n\n  // the buffer that accumulates the output. Initialized in `$sink.i()`\n  var buf, err;\n\n  // the bottom of the 'codegen' stream. Mirrors the `$filter` plugin API.\n  var $sink = {\n    init: function(){buf=[], err=[];},\n    done: function (raw) {\n      if (err.length != 0) throw new Error('j2c error(s): ' + JSON.stringify(err,null,2) + 'in context:\\n' + buf.join(''))\n      return raw ? buf : buf.join('')\n    },\n    err: function(msg) {\n      err.push(msg);\n      buf.push('/* +++ ERROR +++ ' + msg + ' */\\n');\n    },\n    atrule: function (rule, kind, param, takesBlock) {\n      buf.push(rule, param && ' ', param, takesBlock ? ' {' : ';', _instance.endline);\n    },\n    // close atrule\n    _atrule: function () {buf.push('}', _instance.endline);},\n    rule: function (selector) {buf.push(selector, ' {', _instance.endline);},\n    // close rule\n    _rule: function () {buf.push('}', _instance.endline);},\n    decl: function (prop, value) {buf.push(prop, prop && ':', value, ';', _instance.endline);}\n  };\n\n  // holds the `$filter` and `$at` handlers\n  var $filters = [closeSelectors];\n  var $atHandlers = [];\n\n  // the public API (see the main docs)\n  var _instance = {\n    at: at,\n    global: global,\n    kv: kv,\n    names: {},\n    endline: '\\n',\n    suffix: '__j2c-' +\n      // 128 bits of randomness\n      Math.floor(Math.random() * 0x100000000).toString(36) + '-' +\n      Math.floor(Math.random() * 0x100000000).toString(36) + '-' +\n      Math.floor(Math.random() * 0x100000000).toString(36) + '-' +\n      Math.floor(Math.random() * 0x100000000).toString(36),\n    $plugins: [],\n    sheet: function(tree) {\n      var emit = _createOrRetrieveStream(0);\n      emit.init();\n      rules(\n        _walkers[0],\n        emit,\n        '', // prefix\n        tree,\n        1,  // local, by default\n        0   // nesting depth\n      );\n\n      return emit.done()\n    },\n    inline: function (tree, options) {\n      var emit = _createOrRetrieveStream(1);\n      emit.init();\n      declarations(\n        _walkers[1],\n        emit,\n        '', // prefix\n        tree,\n        !(options && options.global)   // local, by default\n      );\n      return emit.done()\n    }\n  };\n\n  // The `state` (for the core functions) / `walker` (for the plugins) tables.\n  var _walkers = [\n    // for j2c.sheet\n    {\n      // helpers for locaizing class and animation names\n      localizeReplacer: _localizeReplacer, // second argument to String.prototype.replace\n      localize: _localize,                 // mangles local names\n      names: _instance.names,              // local => mangled mapping\n      $atHandlers: $atHandlers,            // extra at-rules\n      // The core walker methods, to be provided to plugins\n      atrule: atRules,\n      decl: declarations,\n      rule: rules\n    },\n    // likewise, for j2c.inline (idem with `$a`, `a` and `s` removed)\n    {\n      localizeReplacer: _localizeReplacer,\n      localize: _localize,\n      names: _instance.names,\n      decl: declarations\n    }\n  ];\n\n\n  // inner helpers\n\n  var _use = flatIter(function(plugin) {\n    // `~n` is falsy for `n === -1` and truthy otherwise.\n    // Works well to turn the  result of `a.indexOf(x)`\n    // into a value that reflects the presence of `x` in\n    // `a`.\n    if (~_instance.$plugins.indexOf(plugin)) return\n\n    _instance.$plugins.push(plugin);\n\n    if (type.call(plugin) === FUNCTION) plugin = plugin(_instance);\n\n    if (!plugin) return\n\n    flatIter(function(filter) {\n      $filters.push(filter);\n    })(plugin.$filter || emptyArray);\n\n    flatIter(function(handler) {\n      $atHandlers.push(handler);\n    })(plugin.$at || emptyArray);\n\n    defaults(_instance.names, plugin.$names || emptyObject);\n\n    _use(plugin.$plugins || emptyArray);\n\n    $sink = plugin.$sink || $sink;\n\n    defaults(_instance, plugin);\n  });\n\n\n  var _streams = [];\n  /**\n   * returns the codegen streams, creating them if necessary\n   * @param\n   */\n  function _createOrRetrieveStream(inline) {\n    // build the stream processors if needed\n    if (!_streams.length) {\n      // append the $sink as the ultimate filter\n      $filters.push(function(_, inline) {return inline ? {init:$sink.init, decl:$sink.decl, done:$sink.done, err: $sink.err} : $sink});\n      for(var i = 0; i < 2; i++){ // 0 for j2c.sheet, 1 for j2c.inline\n        for (var j = $filters.length; j--;) {\n          _streams[i] = freeze(\n            defaults(\n              $filters[j](_streams[i], !!i),\n              _streams[i]\n            )\n          );\n        }\n      }\n    }\n    return _streams[inline]\n  }\n\n  /**\n   * Returns a localized version of a given name.\n   * Registers the pair in `instnace.name` if needed.\n   *\n   * @param {string} name - the name to localize\n   * @return {string} - the localized version\n   */\n  function _localize(name) {\n    if (!_instance.names[name]) _instance.names[name] = name + _instance.suffix;\n    return _instance.names[name].match(/^\\S+/)\n  }\n\n  /**\n   * Used as second argument for str.replace(localizeRegex, replacer)\n   * `ignore`, `global` and `(dot, name)` are mutually exclusive\n   *\n   * @param {string} match - the whole match (ignored)\n   * @param {string|null} ignore - a comment or a string literal\n   * @param {string|null} global - a global name\n   * @param {string|null} dot - either '.' for a local class name or the empty string otherwise\n   * @param {string|null} name - the name to localize\n   * @return {string}\n   */\n  function _localizeReplacer(match, ignore, global$$1, dot, name) {\n    return ignore || global$$1 || dot + _localize(name)\n  }\n\n  _use(emptyArray.slice.call(arguments));\n  return _instance\n}\n\nmodule.exports = j2c;\n","\nexport const classes = {\n  scrollView:    \"mithril-infinite__scroll-view\",\n  scrollViewX:   \"mithril-infinite__scroll-view--x\",\n  scrollViewY:   \"mithril-infinite__scroll-view--y\",\n  scrollContent: \"mithril-infinite__scroll-content\",\n  content:       \"mithril-infinite__content\",\n  pages:         \"mithril-infinite__pages\",\n  page:          \"mithril-infinite__page\",\n  pageEven:      \"mithril-infinite__page--even\",\n  pageOdd:       \"mithril-infinite__page--odd\",\n  placeholder:   \"mithril-infinite__page--placeholder\",\n  before:        \"mithril-infinite__before\",\n  after:         \"mithril-infinite__after\"\n};\n","/*!\r\n * verge 1.9.1+201402130803\r\n * https://github.com/ryanve/verge\r\n * MIT License 2013 Ryan Van Etten\r\n */\r\n\r\n(function(root, name, make) {\r\n  if (typeof module != 'undefined' && module['exports']) module['exports'] = make();\r\n  else root[name] = make();\r\n}(this, 'verge', function() {\r\n\r\n  var xports = {}\r\n    , win = typeof window != 'undefined' && window\r\n    , doc = typeof document != 'undefined' && document\r\n    , docElem = doc && doc.documentElement\r\n    , matchMedia = win['matchMedia'] || win['msMatchMedia']\r\n    , mq = matchMedia ? function(q) {\r\n        return !!matchMedia.call(win, q).matches;\r\n      } : function() {\r\n        return false;\r\n      }\r\n    , viewportW = xports['viewportW'] = function() {\r\n        var a = docElem['clientWidth'], b = win['innerWidth'];\r\n        return a < b ? b : a;\r\n      }\r\n    , viewportH = xports['viewportH'] = function() {\r\n        var a = docElem['clientHeight'], b = win['innerHeight'];\r\n        return a < b ? b : a;\r\n      };\r\n  \r\n  /** \r\n   * Test if a media query is active. Like Modernizr.mq\r\n   * @since 1.6.0\r\n   * @return {boolean}\r\n   */  \r\n  xports['mq'] = mq;\r\n\r\n  /** \r\n   * Normalized matchMedia\r\n   * @since 1.6.0\r\n   * @return {MediaQueryList|Object}\r\n   */ \r\n  xports['matchMedia'] = matchMedia ? function() {\r\n    // matchMedia must be binded to window\r\n    return matchMedia.apply(win, arguments);\r\n  } : function() {\r\n    // Gracefully degrade to plain object\r\n    return {};\r\n  };\r\n\r\n  /**\r\n   * @since 1.8.0\r\n   * @return {{width:number, height:number}}\r\n   */\r\n  function viewport() {\r\n    return {'width':viewportW(), 'height':viewportH()};\r\n  }\r\n  xports['viewport'] = viewport;\r\n  \r\n  /** \r\n   * Cross-browser window.scrollX\r\n   * @since 1.0.0\r\n   * @return {number}\r\n   */\r\n  xports['scrollX'] = function() {\r\n    return win.pageXOffset || docElem.scrollLeft; \r\n  };\r\n\r\n  /** \r\n   * Cross-browser window.scrollY\r\n   * @since 1.0.0\r\n   * @return {number}\r\n   */\r\n  xports['scrollY'] = function() {\r\n    return win.pageYOffset || docElem.scrollTop; \r\n  };\r\n\r\n  /**\r\n   * @param {{top:number, right:number, bottom:number, left:number}} coords\r\n   * @param {number=} cushion adjustment\r\n   * @return {Object}\r\n   */\r\n  function calibrate(coords, cushion) {\r\n    var o = {};\r\n    cushion = +cushion || 0;\r\n    o['width'] = (o['right'] = coords['right'] + cushion) - (o['left'] = coords['left'] - cushion);\r\n    o['height'] = (o['bottom'] = coords['bottom'] + cushion) - (o['top'] = coords['top'] - cushion);\r\n    return o;\r\n  }\r\n\r\n  /**\r\n   * Cross-browser element.getBoundingClientRect plus optional cushion.\r\n   * Coords are relative to the top-left corner of the viewport.\r\n   * @since 1.0.0\r\n   * @param {Element|Object} el element or stack (uses first item)\r\n   * @param {number=} cushion +/- pixel adjustment amount\r\n   * @return {Object|boolean}\r\n   */\r\n  function rectangle(el, cushion) {\r\n    el = el && !el.nodeType ? el[0] : el;\r\n    if (!el || 1 !== el.nodeType) return false;\r\n    return calibrate(el.getBoundingClientRect(), cushion);\r\n  }\r\n  xports['rectangle'] = rectangle;\r\n\r\n  /**\r\n   * Get the viewport aspect ratio (or the aspect ratio of an object or element)\r\n   * @since 1.7.0\r\n   * @param {(Element|Object)=} o optional object with width/height props or methods\r\n   * @return {number}\r\n   * @link http://w3.org/TR/css3-mediaqueries/#orientation\r\n   */\r\n  function aspect(o) {\r\n    o = null == o ? viewport() : 1 === o.nodeType ? rectangle(o) : o;\r\n    var h = o['height'], w = o['width'];\r\n    h = typeof h == 'function' ? h.call(o) : h;\r\n    w = typeof w == 'function' ? w.call(o) : w;\r\n    return w/h;\r\n  }\r\n  xports['aspect'] = aspect;\r\n\r\n  /**\r\n   * Test if an element is in the same x-axis section as the viewport.\r\n   * @since 1.0.0\r\n   * @param {Element|Object} el\r\n   * @param {number=} cushion\r\n   * @return {boolean}\r\n   */\r\n  xports['inX'] = function(el, cushion) {\r\n    var r = rectangle(el, cushion);\r\n    return !!r && r.right >= 0 && r.left <= viewportW();\r\n  };\r\n\r\n  /**\r\n   * Test if an element is in the same y-axis section as the viewport.\r\n   * @since 1.0.0\r\n   * @param {Element|Object} el\r\n   * @param {number=} cushion\r\n   * @return {boolean}\r\n   */\r\n  xports['inY'] = function(el, cushion) {\r\n    var r = rectangle(el, cushion);\r\n    return !!r && r.bottom >= 0 && r.top <= viewportH();\r\n  };\r\n\r\n  /**\r\n   * Test if an element is in the viewport.\r\n   * @since 1.0.0\r\n   * @param {Element|Object} el\r\n   * @param {number=} cushion\r\n   * @return {boolean}\r\n   */\r\n  xports['inViewport'] = function(el, cushion) {\r\n    // Equiv to `inX(el, cushion) && inY(el, cushion)` but just manually do both \r\n    // to avoid calling rectangle() twice. It gzips just as small like this.\r\n    var r = rectangle(el, cushion);\r\n    return !!r && r.bottom >= 0 && r.right >= 0 && r.top <= viewportH() && r.left <= viewportW();\r\n  };\r\n\r\n  return xports;\r\n}));","import verge from \"verge\";\nimport { classes } from \"./classes\";\n\nconst LEEWAY = 300;\n\nexport const getElementSize = (el, axis) => {\n  const styles = window.getComputedStyle(el);\n  if (axis === \"x\") {\n    const margin = parseFloat(styles.marginLeft) + parseFloat(styles.marginRight);\n    return el.scrollWidth + margin;\n  } else {\n    const margin = parseFloat(styles.marginTop) + parseFloat(styles.marginBottom);\n    return el.scrollHeight + margin;\n  }\n};\n\n// el, axis = \"y\", expand = LEEWAY\nexport const isElementInViewport = ({el, axis = \"y\", leeway = LEEWAY}) => {\n  return axis === \"y\"\n    ? verge.inY(el, leeway) || verge.inY(el, -leeway)\n    : axis === \"x\"\n      ? verge.inX(el, leeway) || verge.inX(el, -leeway)\n      : verge.inViewport(el, leeway) || verge.inViewport(el, -leeway);\n};\n\nexport const makeClassName = pageNum => [\n  classes.page,\n  pageNum % 2 === 0 ? classes.pageEven : classes.pageOdd\n].join(\" \");","\"use strict\"\n\nvar guid = 0, HALT = {}\nfunction createStream() {\n\tfunction stream() {\n\t\tif (arguments.length > 0 && arguments[0] !== HALT) updateStream(stream, arguments[0])\n\t\treturn stream._state.value\n\t}\n\tinitStream(stream)\n\n\tif (arguments.length > 0 && arguments[0] !== HALT) updateStream(stream, arguments[0])\n\n\treturn stream\n}\nfunction initStream(stream) {\n\tstream.constructor = createStream\n\tstream._state = {id: guid++, value: undefined, state: 0, derive: undefined, recover: undefined, deps: {}, parents: [], endStream: undefined}\n\tstream.map = stream[\"fantasy-land/map\"] = map, stream[\"fantasy-land/ap\"] = ap, stream[\"fantasy-land/of\"] = createStream\n\tstream.valueOf = valueOf, stream.toJSON = toJSON, stream.toString = valueOf\n\n\tObject.defineProperties(stream, {\n\t\tend: {get: function() {\n\t\t\tif (!stream._state.endStream) {\n\t\t\t\tvar endStream = createStream()\n\t\t\t\tendStream.map(function(value) {\n\t\t\t\t\tif (value === true) unregisterStream(stream), unregisterStream(endStream)\n\t\t\t\t\treturn value\n\t\t\t\t})\n\t\t\t\tstream._state.endStream = endStream\n\t\t\t}\n\t\t\treturn stream._state.endStream\n\t\t}}\n\t})\n}\nfunction updateStream(stream, value) {\n\tupdateState(stream, value)\n\tfor (var id in stream._state.deps) updateDependency(stream._state.deps[id], false)\n\tfinalize(stream)\n}\nfunction updateState(stream, value) {\n\tstream._state.value = value\n\tstream._state.changed = true\n\tif (stream._state.state !== 2) stream._state.state = 1\n}\nfunction updateDependency(stream, mustSync) {\n\tvar state = stream._state, parents = state.parents\n\tif (parents.length > 0 && parents.every(active) && (mustSync || parents.some(changed))) {\n\t\tvar value = stream._state.derive()\n\t\tif (value === HALT) return false\n\t\tupdateState(stream, value)\n\t}\n}\nfunction finalize(stream) {\n\tstream._state.changed = false\n\tfor (var id in stream._state.deps) stream._state.deps[id]._state.changed = false\n}\n\nfunction combine(fn, streams) {\n\tif (!streams.every(valid)) throw new Error(\"Ensure that each item passed to m.prop.combine/m.prop.merge is a stream\")\n\treturn initDependency(createStream(), streams, function() {\n\t\treturn fn.apply(this, streams.concat([streams.filter(changed)]))\n\t})\n}\n\nfunction initDependency(dep, streams, derive) {\n\tvar state = dep._state\n\tstate.derive = derive\n\tstate.parents = streams.filter(notEnded)\n\n\tregisterDependency(dep, state.parents)\n\tupdateDependency(dep, true)\n\n\treturn dep\n}\nfunction registerDependency(stream, parents) {\n\tfor (var i = 0; i < parents.length; i++) {\n\t\tparents[i]._state.deps[stream._state.id] = stream\n\t\tregisterDependency(stream, parents[i]._state.parents)\n\t}\n}\nfunction unregisterStream(stream) {\n\tfor (var i = 0; i < stream._state.parents.length; i++) {\n\t\tvar parent = stream._state.parents[i]\n\t\tdelete parent._state.deps[stream._state.id]\n\t}\n\tfor (var id in stream._state.deps) {\n\t\tvar dependent = stream._state.deps[id]\n\t\tvar index = dependent._state.parents.indexOf(stream)\n\t\tif (index > -1) dependent._state.parents.splice(index, 1)\n\t}\n\tstream._state.state = 2 //ended\n\tstream._state.deps = {}\n}\n\nfunction map(fn) {return combine(function(stream) {return fn(stream())}, [this])}\nfunction ap(stream) {return combine(function(s1, s2) {return s1()(s2())}, [stream, this])}\nfunction valueOf() {return this._state.value}\nfunction toJSON() {return this._state.value != null && typeof this._state.value.toJSON === \"function\" ? this._state.value.toJSON() : this._state.value}\n\nfunction valid(stream) {return stream._state }\nfunction active(stream) {return stream._state.state === 1}\nfunction changed(stream) {return stream._state.changed}\nfunction notEnded(stream) {return stream._state.state !== 2}\n\nfunction merge(streams) {\n\treturn combine(function() {\n\t\treturn streams.map(function(s) {return s()})\n\t}, streams)\n}\ncreateStream[\"fantasy-land/of\"] = createStream\ncreateStream.merge = merge\ncreateStream.combine = combine\ncreateStream.HALT = HALT\n\nif (typeof module !== \"undefined\") module[\"exports\"] = createStream\nelse window.stream = createStream\n","module.exports = require(\"./stream/stream\")","import m from \"mithril\";\nimport prop from \"mithril/stream\";\nimport { getElementSize, makeClassName } from \"./util\";\n\nconst getPageData = url =>\n  m.request({\n    method: \"GET\",\n    url\n  });\n\nconst oninit = ({ state, attrs }) => {\n  const pageNum = attrs.pageNum;\n  let content = prop([]);\n  if (attrs.pageData) {\n    const result = attrs.pageData(pageNum);\n    if (result.then) {\n      // A Promise\n      result.then(content);\n    } else {\n      content = result;\n    }\n  } else if (attrs.pageUrl) {\n    const url = attrs.pageUrl(pageNum);\n    getPageData(url).then(content);\n  }\n\n  const processPageData = attrs.processPageData || ((content, attrs1) =>\n    content && content.length\n      ? content.map((data, index) => attrs.item(data, attrs1, index))\n      : null\n  );\n\n  state.content = content;\n  // Memoize some properties that do not change\n  state.className = makeClassName(pageNum);\n  state.pageTag = attrs.pageTag || \"div\";\n  state.processPageData = processPageData;\n};\n\nconst view = ({state, attrs}) => {\n  const pageId = attrs.pageId;\n  const storedPageSize = attrs.pageSizes[pageId] || 0;\n  let pageSize = 0;\n\n  // attrs/pageSize overrides all measurements on elements here\n  if (attrs.pageSize) {\n    pageSize = attrs.pageSize(state.content());\n    attrs.updatePageSize(pageId, pageSize);\n  }\n\n  const cssSize = pageSize\n    ? pageSize + \"px\"\n    : !attrs.autoSize || (attrs.isScrolling && storedPageSize)\n      ? storedPageSize + \"px\"\n      : \"auto\";\n  const update = dom => {\n    if (pageSize) return;\n    const size = getElementSize(dom, attrs.axis);\n    if (size) {\n      attrs.updatePageSize(pageId, size);\n    }\n    if (!storedPageSize) {\n      // this is the very first measurement\n      // make sure we use the first page size by calling the view again\n      setTimeout(m.redraw, 0);\n    }\n  };\n\n  return m(state.pageTag, {\n    \"data-page\": pageId,\n    class: state.className,\n    style: storedPageSize\n      ? attrs.axis === \"x\"\n        ? { width: cssSize }\n        : { height: cssSize }\n      : null,\n    oncreate: ({ dom }) => update(dom),\n    onupdate: ({ dom }) => update(dom)\n  }, state.processPageData(state.content(), {\n    isScrolling: attrs.isScrolling,\n    pageId: attrs.pageId,\n    pageNum: attrs.pageNum\n  }));\n};\n\nexport const page = {\n  oninit,\n  view\n};\n","import m from \"mithril\";\nimport { makeClassName } from \"./util\";\nimport { classes } from \"./classes\";\n\nexport const placeholder = {\n  oninit: vnode =>\n    // Memoize some properties that do not change\n    vnode.state.className = makeClassName(vnode.attrs.pageNum),\n  view: ({state, attrs}) => {\n    const pageId = attrs.pageId;\n    const storedPageSize = attrs.pageSizes[pageId] || 0;\n    return m(\"div\", {\n      \"data-page\": pageId,\n      class: [\n        classes.placeholder,\n        state.className\n      ].join(\" \"),\n      style: Object.assign(\n        {},\n        attrs.axis === \"x\"\n          ? { width:  storedPageSize + \"px\" }\n          : { height: storedPageSize + \"px\" }\n      )\n    });\n  }\n};\n","import J2c from \"j2c\";\nconst j2c = new J2c();\n\n/*\n * @param id: identifier, used as HTMLElement id for the attached <style></style> element\n * @param styles: list of lists style Objects\n */\nexport const addStyle = (id, ...styles) => {\n  removeStyle(id);\n  const styleEl = document.createElement(\"style\");\n  if (id) {\n    styleEl.setAttribute(\"id\", id);\n  }\n  styles.forEach((styleList) => {\n    // each style returns a list\n    if (Object.keys(styleList).length) {\n      styleList.forEach((style) => {\n        const scoped = { \"@global\": style };\n        const sheet = j2c.sheet(scoped);\n        styleEl.appendChild(document.createTextNode(sheet));\n      });\n    }\n  });\n  document.head.appendChild(styleEl);\n};\n\nconst removeStyle = id => {\n  if (id) {\n    const old = document.getElementById(id);\n    if (old) {\n      old.parentNode.removeChild(old);\n    }\n  }\n};","import { addStyle } from \"./styler\";\nimport { classes } from \"./classes\";\n\nconst styles = [{\n  [\".\" + classes.scrollView]: {\n    \"-webkit-overflow-scrolling\": \"touch\",\n    height: \"100%\",\n\n    [\"&.\" + classes.scrollViewY]: {\n      overflowX: \"hidden\",\n      overflowY: \"auto\",\n      height: \"100%\",\n\n      [\" .\" + classes.scrollContent]: {\n        height: \"100%\"\n      }\n    },\n\n    [\"&.\" + classes.scrollViewX]: {\n      overflowX: \"auto\",\n      overflowY: \"hidden\",\n      width: \"100%\",\n\n      [\" .\" + classes.scrollContent]: {\n        width: \"100%\"\n      }\n    }\n  }\n  // by default unstyled:\n  // mithril-infinite__content\n  // mithril-infinite__pages\n  // mithril-infinite__page\n}];\n\naddStyle(\"mithril-infinite\", styles);\n","import m from \"mithril\";\nimport { classes } from \"./classes\";\nimport { getElementSize, isElementInViewport } from \"./util\";\nimport { page } from \"./page\";\nimport { placeholder } from \"./placeholder\";\nimport \"./css\";\n\nconst SCROLL_WATCH_TIMER = 200;\nconst SEL_PADDING = \"000000\";\n\nconst numToId = pageNum =>\n  SEL_PADDING.substring(0, SEL_PADDING.length - (\"\" + pageNum).length) + pageNum;\n\nconst calculateCurrentPageNum = (scrollAmount, state) => {\n  const pageNumKeys = state.sortedKeys;\n  if (pageNumKeys.length === 0) {\n    return 1;\n  }\n  let acc = state.beforeSize || 0;\n  let currentPageNum = 1;\n  for (let i = 0; i < pageNumKeys.length; i = i + 1) {\n    let pageKey = pageNumKeys[i];\n    if (scrollAmount > acc) {\n      currentPageNum = parseInt(pageKey, 10);\n    }\n    acc += state.pageSizes[pageKey];\n  }\n  return currentPageNum;\n};\n\nconst calculateContentSize = (from, to, state) => {\n  const fromIndex = Math.max(0, from - 1);\n  if (to < fromIndex) {\n    return 0;\n  }\n  const toIndex = to;\n  const pageNumKeys = state.sortedKeys.slice(fromIndex, toIndex);\n  let size = state.beforeSize || 0;\n  size = pageNumKeys.reduce((total, pageKey) => (\n    total += state.pageSizes[pageKey] || 0\n  ), size);\n  size += state.afterSize || 0;\n  return size;\n};\n\nconst isPageInViewport = (page, axis, state, scrollView) => {\n  if (!scrollView) {\n    return false;\n  }\n  const id = numToId(page);\n  const el = scrollView.querySelector(`[data-page=\"${id}\"]`);\n  return isElementInViewport({ el, axis });\n};\n\nconst updatePageSize = state => (pageId, size) => (\n  state.pageSizes[pageId] = size,\n  state.sortedKeys = Object.keys(state.pageSizes).sort()\n);\n\nconst handleScroll = (state, view, action) => {\n  const scroll = () => {\n    state.isScrolling = true;\n    // reset isScrolling state only when scrolling is done\n    clearTimeout(state.scrollWatchScrollingStateId);\n    state.scrollWatchScrollingStateId = setTimeout(() => {\n      state.isScrolling = false;\n      // update pages\n      m.redraw();\n    }, state.scrollThrottle);\n    // throttle updates while scrolling\n    if (!state.scrollWatchUpdateStateId) {\n      state.scrollWatchUpdateStateId = setTimeout(() => {\n        // update pages\n        m.redraw();\n        state.scrollWatchUpdateStateId = null;\n      }, state.scrollThrottle);\n    }\n  };\n  if (action === \"add\") {\n    view.addEventListener(\"scroll\", scroll);\n  } else {\n    view.removeEventListener(\"scroll\", scroll);\n  }\n};\n\nconst updatePart = (dom, whichSize, state, axis) => {\n  const size = getElementSize(dom, axis);\n  if (size) {\n    state[whichSize] = size;\n  }\n};\n\nconst getPageList = (currentPageNum, fromPage, toPage, currentPage, preloadSlots, maxPages) => {\n  const minPageNum = fromPage\n    ? parseInt(fromPage, 10)\n    : currentPage\n      ? currentPage\n      : 1;\n  const maxPageNum = toPage\n    ? parseInt(toPage, 10)\n    : currentPage\n      ? currentPage\n      : maxPages;\n  const pages = [];\n  const prePages = [];\n  for (let i = -preloadSlots; i <= preloadSlots; i = i + 1) {\n    const pageNum = currentPageNum + i;\n    if (pageNum >= minPageNum && pageNum <= maxPageNum) {\n      pages.push(pageNum);\n    }\n  }\n  for (let pageNum = 1; pageNum < pages[0]; pageNum = pageNum + 1) {\n    prePages.push(pageNum);\n  }\n  return {pages, prePages, maxPageNum};\n};\n\nconst oninit = vnode => {\n  const attrs = vnode.attrs;\n  // Memoize some properties that do not change\n  const axis = attrs.axis || \"y\";\n  const whichScroll = axis === \"x\" ? \"scrollLeft\" : \"scrollTop\";\n  const autoSize = (attrs.autoSize !== undefined && attrs.autoSize === false) ? false : true;\n  const pageSize = attrs.pageSize;\n  const scrollThrottle = attrs.throttle !== undefined ? attrs.throttle * 1000 : SCROLL_WATCH_TIMER;\n  const contentTag = attrs.contentTag || \"div\";\n  const classList = [\n    classes.scrollView,\n    axis === \"x\"\n      ? classes.scrollViewX\n      : classes.scrollViewY,\n    attrs.class\n  ].join(\" \");\n\n  vnode.state = Object.assign(\n    {},\n    {\n      pageSizes: {},\n      sortedKeys: [],\n      beforeSize: null,\n      afterSize: null,\n      scrollView: null,\n      isScrolling: false,\n      scrollWatchScrollingStateId: null,\n      scrollWatchUpdateStateId: null,\n      preloadSlots: attrs.preloadPages || 1,\n      boundingClientRect: {},\n      currentPageNum: 0,\n      scrollAmount: 0,\n\n      // Memoized\n      classList,\n      axis,\n      whichScroll,\n      autoSize,\n      pageSize,\n      scrollThrottle,\n      contentTag\n    }\n  );\n};\n\nconst view = ({state, attrs}) => {\n  state.scrollAmount = state.scrollView ? state.scrollView[state.whichScroll] : 0;\n  const axis = state.axis;\n  const maxPages = attrs.maxPages !== undefined ? attrs.maxPages : Number.MAX_VALUE;\n\n  const currentPageNum = attrs.currentPage\n    ? parseInt(attrs.currentPage, 10)\n    : calculateCurrentPageNum(state.scrollAmount, state);\n\n  if (attrs.pageChange && currentPageNum !== state.currentPageNum) {\n    attrs.pageChange(currentPageNum);\n  }\n  state.currentPageNum = currentPageNum;\n\n  if (state.scrollView && attrs.getDimensions) {\n    attrs.getDimensions({\n      scrolled: state.scrollAmount,\n      size: state.contentSize\n    });\n  }\n\n  const {pages, prePages, maxPageNum} = getPageList(currentPageNum, attrs.from, attrs.to, attrs.currentPage, state.preloadSlots, maxPages);\n\n  state.contentSize = calculateContentSize(1, maxPageNum, state);\n  const isLastPageVisible = maxPageNum\n    ? isPageInViewport(maxPageNum, axis, state, state.scrollView)\n    : true;\n\n  if (state.scrollView) {\n    // in case the screen size was changed, reset preloadSlots\n    const boundingClientRect = state.scrollView.getBoundingClientRect();\n    state.boundingClientRect = state.boundingClientRect || boundingClientRect;\n    if (boundingClientRect.width !== state.boundingClientRect.width\n      || boundingClientRect.height !== state.boundingClientRect.height\n    ) {\n      state.preloadSlots = attrs.preloadPages || 1;\n    }\n    state.boundingClientRect = boundingClientRect;\n    // calculate if we have room to load more\n    const maxSlots = attrs.maxPreloadPages || Number.MAX_VALUE;\n\n    if (state.contentSize\n      && (state.preloadSlots < pages.length)\n      && (state.preloadSlots <= maxSlots)\n      && (state.contentSize < boundingClientRect.height)\n    ) {\n      state.preloadSlots++;\n      setTimeout(m.redraw, 0);\n    }\n  }\n\n  return m(\"div\",\n    {\n      oncreate: ({ dom }) => {\n        state.scrollView = attrs.scrollView\n          ? document.querySelector(attrs.scrollView)\n          : dom;\n        state.scrollView.className += \" \" + state.classList;\n\n        if (attrs.setDimensions) {\n          const dimensions = attrs.setDimensions();\n          if (dimensions.size > 0) {\n            const whichSize = axis === \"x\"\n              ? \"width\"\n              : \"height\";\n            dom.style[whichSize] = dimensions.size + \"px\";\n          }\n          state.scrollView[state.whichScroll] = dimensions.scrolled;\n        }\n        handleScroll(state, state.scrollView, \"add\");\n      },\n      onremove: () => handleScroll(state, state.scrollView, \"remove\")\n    },\n    m(\"div\",\n      {\n        class: classes.scrollContent,\n        style: !state.autoSize\n          ? null\n          : Object.assign(\n            {},\n            axis === \"x\"\n              ? { width: state.contentSize + \"px\" }\n              : { height: state.contentSize + \"px\" },\n            attrs.contentSize\n              ? axis === \"x\"\n                ? { \"min-width\": attrs.contentSize + \"px\" }\n                : { \"min-height\": attrs.contentSize + \"px\" }\n              : {}\n        )\n      },\n      [\n        m(state.contentTag, { class: classes.content }, [\n          attrs.before\n            ? m(\"div\", {\n              class: classes.before,\n              oncreate: ({ dom }) => updatePart(dom, \"before\", state, axis),\n              onupdate: ({ dom }) => updatePart(dom, \"before\", state, axis)\n            }, attrs.before)\n            : null,\n          m(\"div\", { class: classes.pages }, [\n            prePages.map(pageNum => \n              m(placeholder, Object.assign(\n                {},\n                {\n                  axis,\n                  key: numToId(pageNum),\n                  pageId: numToId(pageNum),\n                  pageNum,\n                  pageSizes: state.pageSizes\n                }\n              ))\n            ),\n            pages.map(pageNum =>\n              m(page, Object.assign(\n                {},\n                {\n                  autoSize: state.autoSize,\n                  axis,\n                  isScrolling: state.isScrolling,\n                  item: attrs.item,\n                  key: numToId(pageNum),\n                  pageData: attrs.pageData,\n                  pageId: numToId(pageNum),\n                  pageNum,\n                  pageSize: state.pageSize,\n                  pageSizes: state.pageSizes,\n                  pageTag: attrs.pageTag,\n                  pageUrl: attrs.pageUrl,\n                  updatePageSize: updatePageSize(state)\n                }\n              ))\n            )\n          ]),\n          // only show \"after\" when content is available\n          attrs.after && state.contentSize\n            ? m(\"div\", {\n              class: classes.after,\n              style: {\n                // visually hide this element until the last page is into view\n                // to prevent flashes of after content when scrolling fast\n                visibility: isLastPageVisible ? \"visible\" : \"hidden\"\n              },\n              oncreate: ({ dom }) => updatePart(dom, \"after\", state, axis),\n              onupdate: ({ dom }) => updatePart(dom, \"after\", state, axis),\n            }, attrs.after)\n            : null\n        ])\n      ]\n    )\n  );\n};\n\nexport const infinite = {\n  oninit,\n  view,\n  isElementInViewport\n};\n\n"],"names":["defaults","target","source","k","own","call","indexOf","cartesian","a","b","i","j","res","push","splitSelector","selector","o","indices","inParen","selectorTokenizer","exec","index","length","unshift","slice","ampersand","parents","split","ampersandTokenizer","join","flatIter","f","iter","arg","type","ARRAY","decamelize","match","toLowerCase","declarations","state","emit","prefix","local","v","kk","valueOf","OBJECT","test","replace","map","localizeReplacer","decl","atRules","nestingDepth","$atHandlers","err","JSON","stringify","adoptee","asString","localize","names","atrule","_atrule","rules","tree","inDeclaration","rule","STRING","closeSelectors","next","inline","lastSelector","init","raw","_rule","done","kind","param","takesBlock","global","x","kv","at","params","block","arguments","_at","bind","apply","concat","toString","j2c","_createOrRetrieveStream","_streams","_","$sink","$filters","freeze","_localize","name","_instance","suffix","_localizeReplacer","ignore","global$$1","dot","buf","Error","msg","endline","prop","value","floor","Math","random","_walkers","options","_use","plugin","$plugins","FUNCTION","filter","$filter","emptyArray","handler","$at","$names","emptyObject","classes","root","make","module","this","viewport","width","viewportW","height","viewportH","calibrate","coords","cushion","rectangle","el","nodeType","getBoundingClientRect","aspect","h","w","xports","win","window","doc","document","docElem","documentElement","matchMedia","mq","q","matches","pageXOffset","scrollLeft","pageYOffset","scrollTop","r","right","left","bottom","top","LEEWAY","getElementSize","axis","styles","getComputedStyle","margin","parseFloat","marginLeft","marginRight","scrollWidth","marginTop","marginBottom","scrollHeight","isElementInViewport","leeway","verge","inY","inX","inViewport","makeClassName","page","pageNum","pageEven","pageOdd","createStream","stream","HALT","updateStream","_state","initStream","constructor","id","guid","undefined","derive","recover","deps","endStream","ap","toJSON","defineProperties","get","unregisterStream","finalize","updateState","changed","updateDependency","mustSync","every","active","some","combine","fn","streams","valid","initDependency","dep","notEnded","registerDependency","parent","dependent","splice","s1","s2","merge","s","require$$0","getPageData","m","request","oninit","attrs","content","pageData","result","then","pageUrl","url","processPageData","attrs1","data","item","className","pageTag","view","pageId","storedPageSize","pageSizes","pageSize","updatePageSize","cssSize","autoSize","isScrolling","update","size","dom","redraw","placeholder","vnode","babelHelpers.extends","hasOwnProperty","Object","J2c","addStyle","styleEl","createElement","setAttribute","forEach","styleList","keys","style","scoped","@global","sheet","appendChild","createTextNode","head","removeStyle","old","getElementById","parentNode","removeChild","scrollView","scrollViewY","scrollContent","scrollViewX","SCROLL_WATCH_TIMER","SEL_PADDING","numToId","substring","calculateCurrentPageNum","scrollAmount","pageNumKeys","sortedKeys","acc","beforeSize","currentPageNum","pageKey","parseInt","calculateContentSize","from","to","fromIndex","max","toIndex","reduce","total","afterSize","isPageInViewport","querySelector","sort","handleScroll","action","scroll","scrollWatchScrollingStateId","setTimeout","scrollThrottle","scrollWatchUpdateStateId","addEventListener","removeEventListener","updatePart","whichSize","getPageList","fromPage","toPage","currentPage","preloadSlots","maxPages","minPageNum","maxPageNum","pages","prePages","whichScroll","throttle","contentTag","classList","class","preloadPages","Number","MAX_VALUE","pageChange","getDimensions","contentSize","isLastPageVisible","boundingClientRect","maxSlots","maxPreloadPages","setDimensions","dimensions","scrolled","min-width","min-height","before","after","infinite"],"mappings":"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"}