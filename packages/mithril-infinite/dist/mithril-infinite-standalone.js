!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("mithril")):"function"==typeof define&&define.amd?define(["mithril"],t):e.polythene=t(e.m)}(this,function(e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var t={scrollView:"mithril-infinite__scroll-view",scrollViewX:"mithril-infinite__scroll-view--x",scrollViewY:"mithril-infinite__scroll-view--y",scrollContent:"mithril-infinite__scroll-content",content:"mithril-infinite__content",pages:"mithril-infinite__pages",page:"mithril-infinite__page",pageEven:"mithril-infinite__page--even",pageOdd:"mithril-infinite__page--odd",placeholder:"mithril-infinite__page--placeholder",before:"mithril-infinite__before",after:"mithril-infinite__after"},n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(e,t){return e(t={exports:{}},t.exports),t.exports}var i=r(function(e){var t,r;t=n,r=function(){var e={},t="undefined"!=typeof window&&window,n="undefined"!=typeof document&&document,r=n&&n.documentElement,i=t.matchMedia||t.msMatchMedia,o=i?function(e){return!!i.call(t,e).matches}:function(){return!1},a=e.viewportW=function(){var e=r.clientWidth,n=t.innerWidth;return e<n?n:e},s=e.viewportH=function(){var e=r.clientHeight,n=t.innerHeight;return e<n?n:e};function c(){return{width:a(),height:s()}}function u(e,t){return!(!(e=e&&!e.nodeType?e[0]:e)||1!==e.nodeType)&&function(e,t){var n={};return t=+t||0,n.width=(n.right=e.right+t)-(n.left=e.left-t),n.height=(n.bottom=e.bottom+t)-(n.top=e.top-t),n}(e.getBoundingClientRect(),t)}return e.mq=o,e.matchMedia=i?function(){return i.apply(t,arguments)}:function(){return{}},e.viewport=c,e.scrollX=function(){return t.pageXOffset||r.scrollLeft},e.scrollY=function(){return t.pageYOffset||r.scrollTop},e.rectangle=u,e.aspect=function(e){var t=(e=null==e?c():1===e.nodeType?u(e):e).height,n=e.width;return t="function"==typeof t?t.call(e):t,(n="function"==typeof n?n.call(e):n)/t},e.inX=function(e,t){var n=u(e,t);return!!n&&n.right>=0&&n.left<=a()},e.inY=function(e,t){var n=u(e,t);return!!n&&n.bottom>=0&&n.top<=s()},e.inViewport=function(e,t){var n=u(e,t);return!!n&&n.bottom>=0&&n.right>=0&&n.top<=s()&&n.left<=a()},e},e.exports?e.exports=r():t.verge=r()}),o=function(e,t){var n=window.getComputedStyle(e);if("x"===t){var r=parseFloat(n.marginLeft)+parseFloat(n.marginRight);return e.scrollWidth+r}var i=parseFloat(n.marginTop)+parseFloat(n.marginBottom);return e.scrollHeight+i},a=function(e){var t=e.el,n=e.axis,r=void 0===n?"y":n,o=e.leeway,a=void 0===o?300:o;return"y"===r?i.inY(t,a)||i.inY(t,-a):"x"===r?i.inX(t,a)||i.inX(t,-a):i.inViewport(t,a)||i.inViewport(t,-a)},s=function(e){return[t.page,e%2==0?t.pageEven:t.pageOdd].join(" ")},c=r(function(e){!function(){var t=0,n={};function r(){function e(){return arguments.length>0&&arguments[0]!==n&&i(e,arguments[0]),e._state.value}return function(e){e.constructor=r,e._state={id:t++,value:void 0,state:0,derive:void 0,recover:void 0,deps:{},parents:[],endStream:void 0,unregister:void 0},e.map=e["fantasy-land/map"]=u,e["fantasy-land/ap"]=l,e["fantasy-land/of"]=r,e.valueOf=f,e.toJSON=h,e.toString=f,Object.defineProperties(e,{end:{get:function(){if(!e._state.endStream){var t=r();t.map(function(n){return!0===n&&(c(e),t._state.unregister=function(){c(t)}),n}),e._state.endStream=t}return e._state.endStream}}})}(e),arguments.length>0&&arguments[0]!==n&&i(e,arguments[0]),e}function i(e,t){for(var n in o(e,t),e._state.deps)a(e._state.deps[n],!1);null!=e._state.unregister&&e._state.unregister(),function(e){for(var t in e._state.changed=!1,e._state.deps)e._state.deps[t]._state.changed=!1}(e)}function o(e,t){e._state.value=t,e._state.changed=!0,2!==e._state.state&&(e._state.state=1)}function a(e,t){var r=e._state.parents;if(r.length>0&&r.every(p)&&(t||r.some(g))){var i=e._state.derive();if(i===n)return!1;o(e,i)}}function s(e,t){if(!t.every(d))throw new Error("Ensure that each item passed to stream.combine/stream.merge is a stream");return function(e,t,n){var r=e._state;return r.derive=n,r.parents=t.filter(v),function e(t,n){for(var r=0;r<n.length;r++)n[r]._state.deps[t._state.id]=t,e(t,n[r]._state.parents)}(e,r.parents),a(e,!0),e}(r(),t,function(){return e.apply(this,t.concat([t.filter(g)]))})}function c(e){for(var t=0;t<e._state.parents.length;t++){delete e._state.parents[t]._state.deps[e._state.id]}for(var n in e._state.deps){var r=e._state.deps[n],i=r._state.parents.indexOf(e);i>-1&&r._state.parents.splice(i,1)}e._state.state=2,e._state.deps={}}function u(e){return s(function(t){return e(t())},[this])}function l(e){return s(function(e,t){return e()(t())},[e,this])}function f(){return this._state.value}function h(){return null!=this._state.value&&"function"==typeof this._state.value.toJSON?this._state.value.toJSON():this._state.value}function d(e){return e._state}function p(e){return 1===e._state.state}function g(e){return e._state.changed}function v(e){return 2!==e._state.state}r["fantasy-land/of"]=r,r.merge=function(e){return s(function(){return e.map(function(e){return e()})},e)},r.combine=s,r.scan=function(e,t,n){var r=s(function(n){return t=e(t,n._state.value)},[n]);return 0===r._state.state&&r(t),r},r.scanMerge=function(e,t){var n=e.map(function(e){var t=e[0];return 0===t._state.state&&t(void 0),t});return s(function(){var r=arguments[arguments.length-1];return n.forEach(function(n,i){r.indexOf(n)>-1&&(t=e[i][1](t,n._state.value))}),t},n)},r.HALT=n,e.exports=r}()}),u=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var n=-1;return e.some(function(e,r){return e[0]===t&&(n=r,!0)}),n}return function(){function t(){this.__entries__=[]}var n={size:{configurable:!0}};return n.size.get=function(){return this.__entries__.length},t.prototype.get=function(t){var n=e(this.__entries__,t),r=this.__entries__[n];return r&&r[1]},t.prototype.set=function(t,n){var r=e(this.__entries__,t);~r?this.__entries__[r][1]=n:this.__entries__.push([t,n])},t.prototype.delete=function(t){var n=this.__entries__,r=e(n,t);~r&&n.splice(r,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var n=0,r=this.__entries__;n<r.length;n+=1){var i=r[n];e.call(t,i[1],i[0])}},Object.defineProperties(t.prototype,n),t}()}(),l="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,f="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),h="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(f):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)},d=2,p=["top","right","bottom","left","width","height","size","weight"],g="undefined"!=typeof MutationObserver,v=function(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var n=!1,r=!1,i=0;function o(){n&&(n=!1,e()),r&&s()}function a(){h(o)}function s(){var e=Date.now();if(n){if(e-i<d)return;r=!0}else n=!0,r=!1,setTimeout(a,t);i=e}return s}(this.refresh.bind(this),20)};v.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},v.prototype.removeObserver=function(e){var t=this.observers_,n=t.indexOf(e);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},v.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},v.prototype.updateObservers_=function(){var e=this.observers_.filter(function(e){return e.gatherActive(),e.hasActive()});return e.forEach(function(e){return e.broadcastActive()}),e.length>0},v.prototype.connect_=function(){l&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),g?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},v.prototype.disconnect_=function(){l&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},v.prototype.onTransitionEnd_=function(e){var t=e.propertyName;void 0===t&&(t=""),p.some(function(e){return!!~t.indexOf(e)})&&this.refresh()},v.getInstance=function(){return this.instance_||(this.instance_=new v),this.instance_},v.instance_=null;var m=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n+=1){var i=r[n];Object.defineProperty(e,i,{value:t[i],enumerable:!1,writable:!1,configurable:!0})}return e},_=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||f},w=O(0,0,0,0);function b(e){return parseFloat(e)||0}function y(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];return t.reduce(function(t,n){return t+b(e["border-"+n+"-width"])},0)}function S(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return w;var r=_(e).getComputedStyle(e),i=function(e){for(var t={},n=0,r=["top","right","bottom","left"];n<r.length;n+=1){var i=r[n],o=e["padding-"+i];t[i]=b(o)}return t}(r),o=i.left+i.right,a=i.top+i.bottom,s=b(r.width),c=b(r.height);if("border-box"===r.boxSizing&&(Math.round(s+o)!==t&&(s-=y(r,"left","right")+o),Math.round(c+a)!==n&&(c-=y(r,"top","bottom")+a)),!function(e){return e===_(e).document.documentElement}(e)){var u=Math.round(s+o)-t,l=Math.round(c+a)-n;1!==Math.abs(u)&&(s-=u),1!==Math.abs(l)&&(c-=l)}return O(i.left,i.top,s,c)}var z="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof _(e).SVGGraphicsElement}:function(e){return e instanceof _(e).SVGElement&&"function"==typeof e.getBBox};function x(e){return l?z(e)?function(e){var t=e.getBBox();return O(0,0,t.width,t.height)}(e):S(e):w}function O(e,t,n,r){return{x:e,y:t,width:n,height:r}}var E=function(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=O(0,0,0,0),this.target=e};E.prototype.isActive=function(){var e=x(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},E.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e};var A=function(e,t){var n,r,i,o,a,s,c,u=(r=(n=t).x,i=n.y,o=n.width,a=n.height,s="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,c=Object.create(s.prototype),m(c,{x:r,y:i,width:o,height:a,top:i,right:r+o,bottom:a+i,left:r}),c);m(this,{target:e,contentRect:u})},M=function(e,t,n){if(this.activeObservations_=[],this.observations_=new u,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=n};M.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof _(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new E(e)),this.controller_.addObserver(this),this.controller_.refresh())}},M.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof _(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},M.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},M.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&e.activeObservations_.push(t)})},M.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map(function(e){return new A(e.target,e.broadcastRect())});this.callback_.call(e,t,e),this.clearActive()}},M.prototype.clearActive=function(){this.activeObservations_.splice(0)},M.prototype.hasActive=function(){return this.activeObservations_.length>0};var P="undefined"!=typeof WeakMap?new WeakMap:new u,T=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=v.getInstance(),r=new M(t,n,this);P.set(this,r)};["observe","unobserve","disconnect"].forEach(function(e){T.prototype[e]=function(){return(t=P.get(this))[e].apply(t,arguments);var t}});var V=void 0!==f.ResizeObserver?f.ResizeObserver:T,R={oninit:function(t){var n=t.state,r=t.attrs,i=r.pageNum,o=c([]);if(r.pageData){var a=r.pageData(i);Promise.resolve(a).then(o).then(e.redraw)}else r.pageUrl&&function(t){return e.request({method:"GET",url:t})}(r.pageUrl(i)).then(o);var u=r.processPageData||function(e,t){return e&&e.length?e.map(function(e,n){return r.item(e,t,n)}):null};n.content=o,n.className=s(i),n.pageTag=r.pageTag||"div",n.processPageData=u},view:function(t){var n=t.state,r=t.attrs,i=r.pageId,a=r.pageSizes[i]||0,s=0;r.pageSize&&(s=r.pageSize(n.content()),r.updatePageSize(i,s));var c=s?s+"px":r.autoSize?"auto":a+"px",u=function(e){if(!s){var t=o(e,r.axis);t&&r.updatePageSize(i,t)}};return e(n.pageTag,{"data-page":i,class:n.className,style:a?"x"===r.axis?{width:c}:{height:c}:null,oncreate:function(e){var t=e.dom;new V(function(e){var n=!0,i=!1,o=void 0;try{for(var s,c=e[Symbol.iterator]();!(n=(s=c.next()).done);n=!0){var l=s.value.contentRect,f=l.width,h=l.height;("x"===r.axis&&f!==a||"y"===r.axis&&h!==a)&&u(t)}}catch(e){i=!0,o=e}finally{try{!n&&c.return&&c.return()}finally{if(i)throw o}}}).observe(t)},onupdate:function(e){var t=e.dom;return u(t)}},n.processPageData(n.content(),{pageId:r.pageId,pageNum:r.pageNum}))}},j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},N={oninit:function(e){return e.state.className=s(e.attrs.pageNum)},view:function(n){var r=n.state,i=n.attrs,o=i.pageId,a=i.pageSizes[o]||0;return e("div",{"data-page":o,class:[t.placeholder,r.className].join(" "),style:j({},"x"===i.axis?{width:a+"px"}:{height:a+"px"})})}},$=[],C={},k=C.toString,D=k.call($),L=k.call(C),I=k.call(""),Z=k.call(k),H=C.hasOwnProperty,X=Object.freeze||function(e){return e};function q(e,t){for(var n in t)H.call(t,n)&&(!n.indexOf("$")||n in e||(e[n]=t[n]));return e}function W(e,t){var n,r,i=[];for(r in t)if(H.call(t,r))for(n in e)H.call(e,n)&&i.push(e[n]+t[r]);return i}var Y=/[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;function B(e){for(var t,n=[],r=[],i=0;t=Y.exec(e);)switch(t[0]){case"(":i++;break;case")":i--;break;case",":if(i)break;n.push(t.index)}for(t=n.length;t--;)r.unshift(e.slice(n[t]+1)),e=e.slice(0,n[t]);return r.unshift(e),r}var F=/&|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;function U(e,t){for(var n,r,i=[],o=[];r=F.exec(e);)"&"==r[0]&&i.push(r.index);for(r=i.length;r--;)o.unshift(e.slice(i[r]+1)),e=e.slice(0,i[r]);for(o.unshift(e),1===o.length&&o.unshift(""),n=[o[0]],r=1;r<o.length;r++)n=W(n,W(t,[o[r]]));return n.join(",")}function G(e){return function t(n){if(k.call(n)===D)for(var r=0;r<n.length;r++)t(n[r]);else e(n)}}function J(e){return"-"+e.toLowerCase()}function K(e,t,n,r,i){var o,a,s;if(null!=r)switch(k.call(r=r.valueOf())){case D:for(o=0;o<r.length;o++)K(e,t,n,r[o],i);break;case L:for(o in n=n&&n+"-",r)if(H.call(r,o))if(a=r[o],/\$/.test(o))for(s in o=o.split("$"))H.call(o,s)&&K(e,t,n+o[s],a,i);else K(e,t,n+o,a,i);break;default:o=n.replace(/_/g,"-").replace(/[A-Z]/g,J),!i||"animation-name"!=o&&"animation"!=o&&"list-style"!=o||(r=r.split(",").map(function(t){return t.replace(/^\s*(?:(var\([^)]+\))|:?global\(\s*([_A-Za-z][-\w]*)\s*\)|()(-?[_A-Za-z][-\w]*))/,e.localizeReplacer)}).join(",")),t.decl(o,r)}}function Q(e,t,n,r,i,o,a){for(var s=0;s<e.$atHandlers.length;s++)if(e.$atHandlers[s](e,t,n,r,i,o,a))return;if(!n[3]&&/^global$/.test(n[2]))ee(e,t,i,r,0,a);else if(!n[3]&&/^local$/.test(n[2]))ee(e,t,i,r,1,a);else if(n[3]&&/^adopt$/.test(n[2])){if(!o||a)return t.err("@adopt global or nested: "+n[0]);if(!/^\.?[_A-Za-z][-\w]*$/.test(n[3]))return t.err("bad adopter "+JSON.stringify(n[3])+" in "+n[0]);s=[],G(function(e,r){null!=e&&/^\.?[_A-Za-z][-\w]*(?:\s+\.?[_A-Za-z][-\w]*)*$/.test(r=e+"")?s.push(r.replace(/\./g,"")):t.err("bad adoptee "+JSON.stringify(e)+" in "+n[0])})(r),s.length&&(e.localize(n[3]=n[3].replace(/\./g,"")),e.names[n[3]]+=" "+s.join(" "))}else!n[3]&&/^(?:namespace|import|charset)$/.test(n[2])?G(function(e){t.atrule(n[1],n[2],e)})(r):!n[3]&&/^(?:font-face|viewport)$/.test(n[2])?G(function(r){t.atrule(n[1],n[2],n[3],1),K(e,t,"",r,o),t._atrule()})(r):n[3]&&/^(?:media|supports|page|keyframes)$/.test(n[2])?(o&&"keyframes"==n[2]&&(n[3]=n[3].replace(/(var\([^)]+\))|:?global\(\s*([_A-Za-z][-\w]*)\s*\)|()(-?[_A-Za-z][-\w]*)/,e.localizeReplacer)),t.atrule(n[1],n[2],n[3],1),"page"==n[2]?K(e,t,"",r,o):ee(e,t,"keyframes"==n[2]?"":i,r,o,a+1),t._atrule()):t.err("Unsupported at-rule: "+n[0])}function ee(e,t,n,r,i,o){var a,s,c,u;switch(k.call(r)){case L:for(a in r)if(H.call(r,a))if(s=r[a],n.length>0&&/^[-\w$]+$/.test(a))if(c||(c=1,t.rule(n)),/\$/.test(a))for(u in a=a.split("$"))H.call(a,u)&&K(e,t,a[u],s,i);else K(e,t,a,s,i);else/^@/.test(a)?(c=0,Q(e,t,/^(.(?:-[\w]+-)?([_A-Za-z][-\w]*))\b\s*(.*?)\s*$/.exec(a)||[a,"@","",""],s,n,i,o)):(c=0,ee(e,t,n.length>0&&(/,/.test(n)||/,/.test(a))?(u=B(n),B(i?a.replace(/("(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\/)|:global\(\s*(\.-?[_A-Za-z][-\w]*)\s*\)|(\.)(-?[_A-Za-z][-\w]*)/g,e.localizeReplacer):a).map(function(e){return/&/.test(e)?U(e,u):u.map(function(t){return t+e}).join(",")}).join(",")):/&/.test(a)?U(i?a.replace(/("(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\/)|:global\(\s*(\.-?[_A-Za-z][-\w]*)\s*\)|(\.)(-?[_A-Za-z][-\w]*)/g,e.localizeReplacer):a,[n]):n+(i?a.replace(/("(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\/)|:global\(\s*(\.-?[_A-Za-z][-\w]*)\s*\)|(\.)(-?[_A-Za-z][-\w]*)/g,e.localizeReplacer):a),s,i,o+1));break;case D:for(a=0;a<r.length;a++)ee(e,t,n,r[a],i,o);break;case I:n.length||t.err("No selector"),t.rule(n||" "),K(e,t,"",r,i)}}function te(e,t){var n;return t?e:{init:function(){n=0,e.init()},done:function(t){return n&&(e._rule(),n=0),e.done(t)},atrule:function(t,r,i,o){n&&(e._rule(),n=0),e.atrule(t,r,i,o)},_atrule:function(t){n&&(e._rule(),n=0),e._atrule(t)},rule:function(t){t!==n&&(n&&e._rule(),e.rule(t),n=t)}}}function ne(e){return":global("+e+")"}function re(e,t,n){return(n={})[e]=t,n}function ie(e,t,n){if(arguments.length<3){var r=ie.bind.apply(ie,[null].concat([].slice.call(arguments,0)));return r.toString=function(){return"@"+e+" "+t},r}return re("@"+e+" "+t,n)}var oe,ae=new function(){var e,t,n={init:function(){e=[],t=[]},done:function(n){if(0!=t.length)throw new Error("j2c error(s): "+JSON.stringify(t,null,2)+"in context:\n"+e.join(""));return n?e:e.join("")},err:function(n){t.push(n),e.push("/* +++ ERROR +++ "+n+" */\n")},atrule:function(t,n,r,i){e.push(t,r&&" ",r,i?" {":";",o.endline)},_atrule:function(){e.push("}",o.endline)},rule:function(t){e.push(t," {",o.endline)},_rule:function(){e.push("}",o.endline)},decl:function(t,n){e.push(t,t&&":",n,";",o.endline)}},r=[te],i=[],o={at:ie,global:ne,kv:re,names:{},endline:"\n",suffix:"__j2c-"+Math.floor(4294967296*Math.random()).toString(36)+"-"+Math.floor(4294967296*Math.random()).toString(36)+"-"+Math.floor(4294967296*Math.random()).toString(36)+"-"+Math.floor(4294967296*Math.random()).toString(36),$plugins:[],sheet:function(e){var t=u(0);return t.init(),ee(a[0],t,"",e,1,0),t.done()},inline:function(e,t){var n=u(1);return n.init(),K(a[1],n,"",e,!(t&&t.global)),n.done()}},a=[{localizeReplacer:f,localize:l,names:o.names,$atHandlers:i,atrule:Q,decl:K,rule:ee},{localizeReplacer:f,localize:l,names:o.names,decl:K}],s=G(function(e){~o.$plugins.indexOf(e)||(o.$plugins.push(e),k.call(e)===Z&&(e=e(o)),e&&(G(function(e){r.push(e)})(e.$filter||$),G(function(e){i.push(e)})(e.$at||$),q(o.names,e.$names||C),s(e.$plugins||$),n=e.$sink||n,q(o,e)))}),c=[];function u(e){if(!c.length){r.push(function(e,t){return t?{init:n.init,decl:n.decl,done:n.done,err:n.err}:n});for(var t=0;t<2;t++)for(var i=r.length;i--;)c[t]=X(q(r[i](c[t],!!t),c[t]))}return c[e]}function l(e){return o.names[e]||(o.names[e]=e+o.suffix),o.names[e].match(/^\S+/)}function f(e,t,n,r,i){return t||n||r+l(i)}return s($.slice.call(arguments)),o},se=function(e){if(e){var t=document.getElementById(e);t&&t.parentNode.removeChild(t)}};function ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];se(e);var i=document.createElement("style");e&&i.setAttribute("id",e),n.forEach(function(e){Object.keys(e).length&&e.forEach(function(e){var t={"@global":e},n=ae.sheet(t);i.appendChild(document.createTextNode(n))})}),document.head.appendChild(i)}("mithril-infinite",[ce({},"."+t.scrollView,(oe={"-webkit-overflow-scrolling":"touch",height:"100%"},ce(oe," ."+t.scrollContent,{overflowAnchor:"none"}),ce(oe,"&."+t.scrollViewY,ce({overflowX:"hidden",overflowY:"auto",height:"100%"}," ."+t.scrollContent,{height:"100%"})),ce(oe,"&."+t.scrollViewX,ce({overflowX:"auto",overflowY:"hidden",width:"100%"}," ."+t.scrollContent,{width:"100%"})),oe))]);var ue=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},le=function(e){return"000000".substring(0,"000000".length-(""+e).length)+e},fe=function(e,t,n,r){var i=o(e,r);i&&(n[t]=i)},he=function(t){if(t.scrollView){var n=t.scrollView.getBoundingClientRect();t.boundingClientRect=t.boundingClientRect||n,n.width===t.boundingClientRect.width&&n.height===t.boundingClientRect.height||(t.preloadSlots=t.attrsPreloadSlots||1),t.boundingClientRect=n,t.contentSize&&t.preloadSlots<t.pageCount&&t.preloadSlots<=t.attrsMaxPreloadSlots&&t.contentSize<n.height&&(t.preloadSlots++,setTimeout(e.redraw,0))}};return{oninit:function(n){var r=n.attrs,i=r.axis||"y",o="x"===i?"scrollLeft":"scrollTop",a=void 0===r.autoSize||!1!==r.autoSize,s=r.pageSize,c=r.contentTag||"div",u=[t.scrollView,"x"===i?t.scrollViewX:t.scrollViewY,r.class].join(" ");n.state={afterSize:null,beforeSize:null,boundingClientRect:{},currentPageNum:0,pageSizes:{},preloadSlots:r.preloadPages||1,scrollView:null,sortedKeys:[],attrsMaxPreloadSlots:r.maxPreloadPages||Number.MAX_VALUE,attrsPreloadSlots:r.preloadPages||1,autoSize:a,axis:i,classList:u,contentTag:c,pageSize:s,scroll:function(){return e.redraw()},whichScroll:o}},view:function(n){var r=n.state,i=n.attrs,o=r.scrollView?r.scrollView[r.whichScroll]:0,s=r.axis,c=void 0!==i.maxPages?i.maxPages:Number.MAX_VALUE,u=i.currentPage?parseInt(i.currentPage,10):function(e,t){var n=t.sortedKeys;if(0===n.length)return 1;for(var r=t.beforeSize||0,i=1,o=0;o<n.length;o+=1){var a=n[o];e>r&&(i=parseInt(a,10)),r+=t.pageSizes[a]}return i}(o,r);i.pageChange&&u!==r.currentPageNum&&i.pageChange(u),r.currentPageNum=u,r.scrollView&&i.getDimensions&&i.getDimensions({scrolled:o,size:r.contentSize});var l=function(e,t,n,r,i,o){for(var a=t?parseInt(t,10):r||1,s=n?parseInt(n,10):r||o,c=[],u=[],l=-i;l<=i;l+=1){var f=e+l;f>=a&&f<=s&&c.push(f)}for(var h=1;h<c[0];h+=1)u.push(h);return{pages:c,prePages:u,maxPageNum:s}}(u,i.from,i.to,i.currentPage,r.preloadSlots,c),f=l.pages,h=l.prePages,d=l.maxPageNum;r.contentSize=void 0!==i.contentSize?i.contentSize:function(e,t,n){var r=Math.max(0,e-1);if(t<r)return 0;var i=t,o=n.sortedKeys.slice(r,i),a=n.beforeSize||0;return a=o.reduce(function(e,t){return e+(n.pageSizes[t]||0)},a),a+=n.afterSize||0}(1,d,r),r.pageCount=f.length;var p=!d||function(e,t,n,r){if(!r)return!1;var i=le(e),o=r.querySelector('[data-page="'+i+'"]');return a({el:o,axis:t})}(d,s,0,r.scrollView);return e("div",{oncreate:function(e){var t=e.dom;if(r.scrollView=i.scrollView?document.querySelector(i.scrollView):t,r.scrollView.className+=" "+r.classList,i.setDimensions){var n=i.setDimensions();if(n.size>0){var o="x"===s?"width":"height";t.style[o]=n.size+"px"}r.scrollView[r.whichScroll]=n.scrolled}r.scrollView.addEventListener("scroll",r.scroll)},onremove:function(){return r.scrollView.removeEventListener("scroll",r.scroll)}},e("div",{class:t.scrollContent,style:r.autoSize?ue({},"x"===s?{width:r.contentSize+"px"}:{height:r.contentSize+"px"},i.contentSize?"x"===s?{"min-width":i.contentSize+"px"}:{"min-height":i.contentSize+"px"}:{}):null},[e(r.contentTag,{class:t.content},[i.before?e("div",{class:t.before,oncreate:function(e){var t=e.dom;return fe(t,"before",r,s)},onupdate:function(e){var t=e.dom;return fe(t,"before",r,s)}},i.before):null,e("div",{class:t.pages},[h.map(function(t){return e(N,{axis:s,key:(i.pageKey||le)(t),pageId:le(t),pageNum:t,pageSizes:r.pageSizes})}),f.map(function(t){return e(R,{autoSize:r.autoSize,axis:s,item:i.item,key:(i.pageKey||le)(t),pageData:i.pageData,pageId:le(t),pageNum:t,pageSize:r.pageSize,pageSizes:r.pageSizes,pageTag:i.pageTag,pageUrl:i.pageUrl,updatePageSize:function(t){return function(n,r){var i=t.pageSizes[n],o=parseInt(r,10);i!==o&&(t.pageSizes[n]=o,t.sortedKeys=Object.keys(t.pageSizes).sort(),he(t),setTimeout(e.redraw,0))}}(r)})})]),i.after&&r.contentSize?e("div",{class:t.after,style:{visibility:p?"visible":"hidden"},oncreate:function(e){var t=e.dom;return fe(t,"after",r,s)},onupdate:function(e){var t=e.dom;return fe(t,"after",r,s)}},i.after):null])]))},isElementInViewport:a}});
//# sourceMappingURL=mithril-infinite-standalone.js.map
