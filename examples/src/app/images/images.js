"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _mithril=require("mithril"),_mithril2=_interopRequireDefault(_mithril),_github=require("app/app/github"),_github2=_interopRequireDefault(_github),_mithrilInfinite=require("mithril-infinite"),_mithrilInfinite2=_interopRequireDefault(_mithrilInfinite),_styler=require("app/app/styler"),_styler2=_interopRequireDefault(_styler),_imagesStyle=require("./images-style"),_imagesStyle2=_interopRequireDefault(_imagesStyle);_styler2["default"].add("images",_imagesStyle2["default"]);var IMG_URL="http://arthurclemens.github.io/assets/mithril-infinite-scroll/thumbs/",vm={expanded:{},dirty:{},toggle:function(id){vm.expanded[id]?delete vm.expanded[id]:vm.expanded[id]=1,vm.dirty[id]=1},isExpanded:function(id){return vm.expanded[id]},isDirty:function(id){return vm.dirty[id]},clearDirty:function(id){return delete vm.dirty[id]}},item=function(data,opts){var id=opts.page+data.src,isExpanded=vm.isExpanded(id),isDirty=vm.isDirty(id),heightFraction=isExpanded?.5:.25;return(0,_mithril2["default"])("a.list-item",{style:{height:Math.floor(parseInt(data.height,10)*heightFraction)+"px"},onclick:function(){vm.toggle(id)}},[(0,_mithril2["default"])("span.pageNum",opts.page),(0,_mithril2["default"])(".image",{style:{height:Math.floor(parseInt(data.height,10)*heightFraction)+"px",width:Math.floor(parseInt(data.width,10)*heightFraction)+"px"},config:function(el,inited,context){if((!context.inited||isDirty)&&_mithrilInfinite2["default"].isElementInViewport({el:el})){var url=IMG_URL+data.src;el.style.backgroundImage=el.style.backgroundImage="url("+url+")",context.inited=!0,vm.clearDirty(id)}}}),(0,_mithril2["default"])(".toggle",isExpanded?_mithril2["default"].trust("&#150;"):_mithril2["default"].trust("&#43;"))])},component={};component.view=function(){return _mithril2["default"].component(_mithrilInfinite2["default"],{maxPages:20,item:item,pageUrl:function(page){return"app/images/data/page-"+page+".json"},preloadPages:3,"class":"images",before:(0,_mithril2["default"])("a",{"class":["list-item",vm.isExpanded("before")?"open":"closed"].join(" "),onclick:function(){vm.toggle("before")}},[(0,_mithril2["default"])("div",_mithril2["default"].trust('A list of pugs. Courtesy the <a href="http://airbnb.io/infinity/demo-off.html">AirBnb Infinity demo</a>.')),(0,_mithril2["default"])(".toggle",vm.isExpanded("before")?_mithril2["default"].trust("&#150;"):_mithril2["default"].trust("&#43;"))]),after:(0,_github2["default"])(),pageChange:function(page){console&&console.log("page",page)}})},exports["default"]=component,module.exports=exports["default"];
//# sourceMappingURL=images.js.map