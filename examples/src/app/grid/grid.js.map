{"version":3,"sources":["grid.es6.js"],"names":["_mithril","require","_github","_mithrilInfinite","_styler","_gridStyle","_styler2","add","_gridStyle2","IMG_URL","vm","seen","showImage","el","imgUrl","url","populate","style","backgroundImage","opacity","img","Image","onload","src","item","data","_mithril2","config","inited","context","_mithrilInfinite2","isElementInViewport","component","view","maxPages","preloadPages","pageUrl","page","class","pageChange","console","log","after","_github2"],"mappings":"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","file":"grid.js","sourcesContent":["'use strict';\n\nimport m from 'mithril';\nimport github from 'app/app/github';\nimport infinite from 'mithril-infinite';\n\nimport styler from 'app/app/styler';\nimport gridStyle from './grid-style';\nstyler.add('grid', gridStyle);\n\n\nconst IMG_URL = 'http://arthurclemens.github.io/assets/mithril-infinite-scroll/thumbs/';\n\nlet vm = {\n    seen: {}\n};\n\n// fade in first time only\nconst showImage = (el, imgUrl) => {\n    const url = IMG_URL + imgUrl;\n    const populate = () => {\n        el.style.backgroundImage = 'url(' + url + ')';\n        el.style.opacity = 1;\n        vm.seen[url] = 1;\n    };\n    if (!vm.seen[url]) {\n        let img = new Image();\n        img.onload = () => {\n            populate();\n        };\n        img.src = url;\n    } else {\n        populate();\n    }\n};\n\nconst item = (data) => {\n    return m('a.grid-item',\n        m('.image-holder',\n            m('.image', {\n                config: (el, inited, context) => {\n                    if (context.inited) {\n                        return;\n                    }\n                    if (infinite.isElementInViewport({el: el})) {\n                        showImage(el, data.src);\n                        context.inited = true;\n                    }\n                }\n            })\n        )\n    );\n};\n\nlet component = {};\ncomponent.view = () => {\n    return m.component(infinite, {\n        maxPages: 16, // pages of 12 items each\n        preloadPages: 3,\n        item: item,\n        pageUrl: page => 'app/grid/data/page-' + page + '.json',\n        class: 'grid',\n        pageChange: page => {\n            if (console) {\n                console.log('page', page);\n            }\n        },\n        after: github()\n    });\n};\n\nexport default component;\n"]}